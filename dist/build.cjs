"use strict";var K=Object.create;var D=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var Y=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty;var j=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ee=(e,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of V(t))!Z.call(e,n)&&n!==i&&D(e,n,{get:()=>t[n],enumerable:!(o=Q(t,n))||o.enumerable});return e};var x=(e,t,i)=>(i=e!=null?K(Y(e)):{},ee(t||!e||!e.__esModule?D(i,"default",{value:e,enumerable:!0}):i,e));var P=j(R=>{R.compile=function(e){var t=R.parse(e),i=t[0],o=t[1];return{accepts:function(n){return n[0]==="/"&&(n=n.slice(1)),o[0].test(n)||!i[0].test(n)},denies:function(n){return n[0]==="/"&&(n=n.slice(1)),!(o[0].test(n)||!i[0].test(n))},maybe:function(n){return n[0]==="/"&&(n=n.slice(1)),o[1].test(n)||!i[1].test(n)}}};R.parse=function(e){return e.split(`
`).map(function(t){return t=t.trim(),t}).filter(function(t){return t&&t[0]!=="#"}).reduce(function(t,i){var o=i[0]==="!";return o&&(i=i.slice(1)),i[0]==="/"&&(i=i.slice(1)),o?t[1].push(i):t[0].push(i),t},[[],[]]).map(function(t){return t.sort().map(te).reduce(function(i,o){return i[0].push(o[0]),i[1].push(o[1]),i},[[],[],[]])}).map(function(t){return[t[0].length>0?new RegExp("^(("+t[0].join(")|(")+"))"):new RegExp("$^"),t[1].length>0?new RegExp("^(("+t[1].join(")|(")+"))"):new RegExp("$^")]})};function te(e){return[C(e),ne(e)]}function C(e){return ie(e).replace("**","(.+)").replace("*","([^\\/]+)")}function ne(e){return e.split("/").map(function(t,i){return i?"([\\/]?("+C(t)+"\\b|$))":"("+C(t)+"\\b)"}).join("")}function ie(e){return e.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$&")}});var q=j((Ce,N)=>{var L=process.platform==="win32",re=L?"\\\\+":"\\/",_=L?"\\\\":"/",se="((?:[^/]*(?:/|$))*)",oe="([^/]*)",F=`((?:[^${_}]*(?:${_}|$))*)`,ce=`([^${_}]*)`;function le(e,{extended:t=!1,globstar:i=!1,strict:o=!1,filepath:n=!1,flags:c=""}={}){let f="",u="",p={regex:"",segments:[]},w=!1,y=!1,a=[];function s(l,{split:g,last:E,only:S}={}){S!=="path"&&(f+=l),n&&S!=="regex"&&(p.regex+=l==="\\/"?re:l,g?(E&&(u+=l),u!==""&&(c.includes("g")||(u=`^${u}$`),p.segments.push(new RegExp(u,c))),u=""):u+=l)}let r,m;for(let l=0;l<e.length;l++){if(r=e[l],m=e[l+1],["\\","$","^",".","="].includes(r)){s(`\\${r}`);continue}if(r==="/"){s(`\\${r}`,{split:!0}),m==="/"&&!o&&(f+="?");continue}if(r==="("){if(a.length){s(r);continue}s(`\\${r}`);continue}if(r===")"){if(a.length){s(r);let g=a.pop();s(g==="@"?"{1}":g==="!"?"([^/]*)":g);continue}s(`\\${r}`);continue}if(r==="|"){if(a.length){s(r);continue}s(`\\${r}`);continue}if(r==="+"){if(m==="("&&t){a.push(r);continue}s(`\\${r}`);continue}if(r==="@"&&t&&m==="("){a.push(r);continue}if(r==="!"){if(t){if(y){s("^");continue}if(m==="("){a.push(r),s("(?!"),l++;continue}s(`\\${r}`);continue}s(`\\${r}`);continue}if(r==="?"){if(t){m==="("?a.push(r):s(".");continue}s(`\\${r}`);continue}if(r==="["){if(y&&m===":"){l++;let g="";for(;e[++l]!==":";)g+=e[l];g==="alnum"?s("(\\w|\\d)"):g==="space"?s("\\s"):g==="digit"&&s("\\d"),l++;continue}if(t){y=!0,s(r);continue}s(`\\${r}`);continue}if(r==="]"){if(t){y=!1,s(r);continue}s(`\\${r}`);continue}if(r==="{"){if(t){w=!0,s("(");continue}s(`\\${r}`);continue}if(r==="}"){if(t){w=!1,s(")");continue}s(`\\${r}`);continue}if(r===","){if(w){s("|");continue}s(`\\${r}`);continue}if(r==="*"){if(m==="("&&t){a.push(r);continue}let g=e[l-1],E=1;for(;e[l+1]==="*";)E++,l++;let S=e[l+1];i?E>1&&(g==="/"||g===void 0)&&(S==="/"||S===void 0)?(s(se,{only:"regex"}),s(F,{only:"path",last:!0,split:!0}),l++):(s(oe,{only:"regex"}),s(ce,{only:"path"})):s(".*");continue}s(r)}c.includes("g")||(f=`^${f}$`,u=`^${u}$`,n&&(p.regex=`^${p.regex}$`));let $={regex:new RegExp(f,c)};return n&&(p.segments.push(new RegExp(u,c)),p.regex=new RegExp(p.regex,c),p.globstar=new RegExp(c.includes("g")?F:`^${F}$`,c),$.path=p),$}N.exports=le});var H=j((Fe,z)=>{"use strict";var ue=require("os"),M=require("path"),fe=ue.platform()==="win32",ae={"{":"}","(":")","[":"]"},pe=/\\(.)|(^!|\*|[\].+)]\?|\[[^\\\]]+\]|\{[^\\}]+\}|\(\?[:!=][^\\)]+\)|\([^|]+\|[^\\)]+\)|(\\).|([@?!+*]\(.*\)))/,ge=/\\(.)|(^!|[*?{}()[\]]|\(\?)/;function I(e,{strict:t=!0}={}){if(e==="")return!1;let i,o=t?pe:ge;for(;i=o.exec(e);){if(i[2])return!0;let n=i.index+i[0].length,c=i[1],f=c?ae[c]:null;if(c&&f){let u=e.indexOf(f,n);u!==-1&&(n=u+1)}e=e.slice(n)}return!1}function he(e,{strict:t=!1}={}){fe&&e.includes("/")&&(e=e.split("\\").join("/")),/[\{\[].*[\/]*.*[\}\]]$/.test(e)&&(e+="/"),e+="a";do e=M.dirname(e);while(I(e,{strict:t})||/(^|[^\\])([\{\[]|\([^\)]+$)/.test(e));return e.replace(/\\([\*\?\|\[\]\(\)\{\}])/g,"$1")}function de(e,t={}){let i=he(e,t),o=I(e,t),n;return i!="."?(n=e.substr(i.length),n.startsWith("/")&&(n=n.substr(1))):n=e,o||(i=M.dirname(e),n=i!=="."?e.substr(i.length):e),n.startsWith("./")&&(n=n.substr(2)),n.startsWith("/")&&(n=n.substr(1)),{base:i,glob:n,isGlob:o}}z.exports=de});var J=j((_e,B)=>{var W=require("fs"),me=q(),ye=H(),{join:T,resolve:k,relative:$e}=require("path"),we=/(^|[\\\/])\.[^\\\/\.]/g,O={};function U(e,t,i,o,n="",c=0){let f=i.segments[c],u=k(o.cwd,t,n),p=W.readdirSync(u),{dot:w,filesOnly:y}=o,a=0,s=p.length,r,m,$,l,g;for(;a<s;a++)if(m=T(u,r=p[a]),$=n?T(n,r):r,!(!w&&we.test($))){if(g=i.regex.test($),(l=O[$])===void 0&&(O[$]=l=W.lstatSync(m)),!l.isDirectory()){g&&e.push($e(o.cwd,m));continue}f&&!f.test(r)||(!y&&g&&e.push(T(t,$)),U(e,t,i,o,$,f&&f.toString()!==i.globstar&&c+1))}}B.exports=function(e,t={}){if(!e)return[];let i=ye(e);if(t.cwd=t.cwd||".",!i.isGlob)try{let c=k(t.cwd,e),f=W.statSync(c);return t.filesOnly&&!f.isFile()?[]:t.absolute?[c]:[e]}catch(c){if(c.code!="ENOENT")throw c;return[]}t.flush&&(O={});let o=[],{path:n}=me(i.glob,{filepath:!0,globstar:!0,extended:!0});return n.globstar=n.globstar.toString(),U(o,i.base,n,t,".",0),t.absolute?o.map(c=>k(t.cwd,c)):o}});var h=x(require("fs"),1),d=x(require("path"),1),G=x(P(),1),A=x(J(),1);var b=x(require("fs"),1);var v=e=>{try{b.default.mkdirSync(e,{recursive:!0})}catch(t){if(t.code==="EEXIST")return;throw t}},X=e=>{(b.default.rmSync||b.default.rmdirSync)(e,{recursive:!0,force:!0})};var Se=e=>e.replace(/\/\*\*\*\//g,"").replace(/\/\*\*([\s\S]+?)(@[\s\S]+?)?\*\/([\s\n]+)/g,(t,i,o,n)=>/^\s+(\*\s*)?$/.test(i)?"":`/**${i.replace(/\*\ $/,"")}*/${n}`),xe=async e=>{let t=h.default.readdirSync("templates");for(let i of t){if(i[0]===".")continue;let o=`dist/templates/${i}`,n=`${o}/assets`;v(n);let c=d.default.resolve("templates",i),f=d.default.join(c,".gitignore");if(!h.default.existsSync(f))throw new Error(`"${i}" template must have a .gitignore file`);let u=G.default.compile(h.default.readFileSync(f,"utf-8")),p=d.default.join(c,".ignore");if(!h.default.existsSync(p))throw new Error("Template must have a .ignore file");let w=G.default.compile(h.default.readFileSync(p,"utf-8")),y=d.default.join(c,".meta.json");if(!h.default.existsSync(y))throw new Error("Template must have a .meta.json file");let a=[];(0,A.default)("**/*",{cwd:c,filesOnly:!0,dot:!0}).forEach(s=>{if(s==="package.template.json"){let r=h.default.readFileSync(d.default.join(c,s),"utf8");r=r.replace(/workspace:\*/g,"next"),h.default.writeFileSync(`${o}/package.json`,r);return}if(!e.has(s)&&!(!u.accepts(s)||!w.accepts(s)||s===".ignore"))if(/\.(ts|svelte)$/.test(s)){let r=h.default.readFileSync(d.default.join(c,s),"utf8");s.endsWith(".d.ts")?a.push({name:s,contents:r}):a.push({name:s,contents:Se(r)})}else{let r=d.default.join(n,s.replace(/^\./,"DOT-"));v(d.default.dirname(r)),h.default.copyFileSync(d.default.join(c,s),r)}}),h.default.copyFileSync(y,`${o}/meta.json`),h.default.writeFileSync(`${o}/files.types=typescript.json`,JSON.stringify(a,null,"	"))}},Ee=async()=>{let e=d.default.resolve("shared"),t=new Set,i=[];return(0,A.default)("**/*",{cwd:e,filesOnly:!0,dot:!0}).forEach(o=>{let n=h.default.readFileSync(d.default.join(e,o),"utf8"),c=[],f=[],u=o;if(o.startsWith("+")||o.startsWith("-")){let[p,...w]=o.split(d.default.sep),y=/([+-])([a-z]+)/g,a;for(;a=y.exec(p);)(a[1]==="+"?c:f).push(a[2]);u=w.join("/")}t.add(u),i.push({name:u,include:c,exclude:f,contents:n})}),i.sort((o,n)=>o.include.length+o.exclude.length-(n.include.length+n.exclude.length)),h.default.writeFileSync("dist/templates/shared.json",JSON.stringify({files:i},null,"	")),t.delete("package.json"),t},je=async()=>{X("dist/templates"),v("dist/templates");let e=await Ee();await xe(e)};je();
//# sourceMappingURL=build.cjs.map