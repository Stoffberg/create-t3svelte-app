#!/usr/bin/env node
"use strict";var P=Object.create;var _=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var T=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var D=(e,t,s,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of E(t))!N.call(e,r)&&r!==s&&_(e,r,{get:()=>t[r],enumerable:!(o=b(t,r))||o.enumerable});return e};var p=(e,t,s)=>(s=e!=null?P(T(e)):{},D(t||!e||!e.__esModule?_(s,"default",{value:e,enumerable:!0}):s,e));var u=p(require("fs"),1),S=p(require("path"),1),n=require("kleur/colors"),w=p(require("prompts"),1);var d=p(require("fs"),1),y=p(require("path"),1);var g=p(require("fs"),1),v=p(require("path"),1),x=require("url"),M={},f=e=>{try{g.default.mkdirSync(e,{recursive:!0})}catch(t){if(t.code==="EEXIST")return;throw t}};function J(e){return e}var k=(e,t,s=J)=>{if(!g.default.existsSync(e))return;g.default.statSync(e).isDirectory()?g.default.readdirSync(e).forEach(r=>{k(v.default.join(e,r),v.default.join(t,s(r)))}):(f(v.default.dirname(t)),g.default.copyFileSync(e,t))},m=e=>(0,x.fileURLToPath)(new URL(`./${e}`,M.url).href),O=()=>{let e=process.env.npm_config_user_agent;return e?e.startsWith("yarn")?"yarn":e.startsWith("pnpm")?"pnpm":"npm":"npm"};var A=async(e,t)=>{f(e),W(t.template,t.name,e),L(e,t,t.name)};function W(e,t,s){let o=m(`templates/${e}`);k(`${o}/assets`,s,i=>i.replace("DOT-",".")),k(`${o}/package.json`,`${s}/package.json`);let r=`${o}/files.types=typescript.json`;JSON.parse(d.default.readFileSync(r,"utf-8")).forEach(i=>{let a=y.default.join(s,i.name);f(y.default.dirname(a)),d.default.writeFileSync(a,i.contents.replace(/~TODO~/g,t))})}function L(e,t,s){let o=m("templates/shared.json"),{files:r}=JSON.parse(d.default.readFileSync(o,"utf-8")),c=y.default.join(e,"package.json"),i=JSON.parse(d.default.readFileSync(c,"utf-8"));R(r).forEach(a=>{let $=a.include.every(l=>j(l,t));if(!(a.exclude.some(l=>j(l,t))||!$))if(a.name==="package.json"){let l=JSON.parse(a.contents);F(i,l)}else{let l=y.default.join(e,a.name);f(y.default.dirname(l)),d.default.writeFileSync(l,a.contents)}}),i.dependencies=C(i.dependencies),i.devDependencies=C(i.devDependencies),i.name=U(s),d.default.writeFileSync(c,JSON.stringify(i,null,"	")+`
`)}var j=(e,t)=>e==="default"?t.template===e:e==="eslint"||e==="prettier"?t.addons.includes(e):e==="prisma"||e==="trpc"||e==="tailwind"||e==="auth"?t.packages.includes(e):t[e],F=(e,t)=>{for(let s in t)if(s in e){let o=e[s],r=t[s];if(typeof r!=typeof o||Array.isArray(r)!==Array.isArray(o))throw new Error("Mismatched values");typeof r=="object"?F(o,r):e[s]=r}else e[s]=t[s]},C=e=>{if(!e)return;let t={};return Object.keys(e).sort().forEach(s=>{t[s]=e[s]}),t},R=e=>e.sort((t,s)=>{let o=t.include.every(a=>s.include.includes(a))&&t.exclude.every(a=>s.exclude.includes(a)),r=s.include.every(a=>t.include.includes(a))&&s.exclude.every(a=>t.exclude.includes(a));return o&&r||!o&&!r?0:o?-1:1}),U=e=>e.trim().toLowerCase().replace(/\s+/g,"-").replace(/^[._]/,"").replace(/[^a-z0-9~.-]+/g,"-");var V={},{version:I}=JSON.parse(u.default.readFileSync(new URL("../package.json",V.url),"utf-8")),h=O(),z=async()=>{console.log((0,n.gray)(`create-t3svelte-app version ${I} run with ${h}`)),console.log(`
${(0,n.bold)((0,n.cyan)("Welcome to ")+(0,n.red)("Create-T3Svelte-App"))}
`);let e=process.argv[2]||".";if(e==="."){let c=await(0,w.default)([{type:"text",name:"dir",message:"What do you want to call the project?"}],{onCancel:()=>process.exit(1)});c.dir&&(e=c.dir)}u.default.existsSync(e)&&u.default.readdirSync(e).length>0&&((await(0,w.default)({type:"confirm",name:"value",message:"Directory not empty. Continue?",initial:!1})).value||process.exit(1));let t=await(0,w.default)([{type:"select",name:"template",message:"What template would you like to use?",choices:u.default.readdirSync(m("templates")).flatMap(c=>{if(!u.default.lstatSync(m(`templates/${c}`)).isDirectory())return[];let i=m(`templates/${c}/meta.json`),{title:a,description:$}=JSON.parse(u.default.readFileSync(i,"utf8"));return{title:a,description:$,value:c}})},{type:"multiselect",name:"packages",message:"What packages would you like to enable?",choices:[{title:"tRPC",value:"trpc",selected:!0},{title:"Prisma",value:"prisma",selected:!0},{title:"Tailwind",value:"tailwind",selected:!0},{title:"Auth",value:"auth",selected:!0}]},{type:"multiselect",name:"addons",message:"What additional tooling do you like to enable?",choices:[{title:"ESLint",value:"eslint",selected:!0},{title:"Prettier",value:"prettier",selected:!0}]}],{onCancel:()=>{process.exit(1)}}),s={...t,name:S.default.basename(S.default.resolve(e)),addons:t.addons,packages:t.packages};await A(e,s),console.log((0,n.bold)((0,n.green)(`
Your project is ready!`))),console.log((0,n.bold)("\u2714 Typescript")),console.log('  Inside Svelte components, use <script lang="ts">'),s.packages.includes("trpc")&&(console.log((0,n.bold)("\u2714 tRPC")),console.log((0,n.cyan)("  https://trpc.io/docs"))),s.packages.includes("prisma")&&(console.log((0,n.bold)("\u2714 Prisma")),console.log((0,n.cyan)("  https://www.prisma.io/docs"))),s.packages.includes("tailwind")&&(console.log((0,n.bold)("\u2714 Tailwind")),console.log((0,n.cyan)("  https://tailwindcss.com/docs"))),s.packages.includes("auth")&&(console.log((0,n.bold)("\u2714 Auth")),console.log((0,n.cyan)("  https://authjs.dev/"))),s.addons.includes("eslint")&&(console.log((0,n.bold)("\u2714 ESLint")),console.log((0,n.cyan)("  https://eslint.org/docs/latest"))),s.addons.includes("prettier")&&(console.log((0,n.bold)("\u2714 Prettier")),console.log((0,n.cyan)("  https://prettier.io/docs/en/index.html"))),console.log(`
Next steps:`);let o=1,r=S.default.relative(process.cwd(),e);r!==""&&console.log(`  ${o++}: ${(0,n.bold)((0,n.cyan)(`cd ${r}`))}`),console.log(`  ${o++}: ${(0,n.bold)((0,n.cyan)(`${h} install`))}`),s.packages.includes("prisma")&&console.log(`  ${o++}: ${(0,n.bold)((0,n.cyan)(`${h} run db-push`))} (optional - sync a database schema)`),console.log(`  ${o++}: ${(0,n.bold)((0,n.cyan)(`${h} run sync`))}`),console.log(`  ${o++}: ${(0,n.bold)((0,n.cyan)(`${h} run dev`))}`),console.log(`
To close the dev server, hit ${(0,n.bold)((0,n.cyan)("Ctrl-C"))}`),console.log(`Stuck? Visit the official svelte website at ${(0,n.cyan)("https://svelte.dev/chat")}
`)};z();
//# sourceMappingURL=index.cjs.map